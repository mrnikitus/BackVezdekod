# Backend

## Список заданий

В данном репозитории находятся решения для задач от 10 до 50 баллов
1. 10 баллов - скрипт для консоли представлен в файле `interface.py` (далее все будет расписано, в том числе и API запрос) 
2. 20 и 30 баллов - в заданиях используются разные способы выдачи мемов, они реализованы под разными адресами API запросов, и в конечной программе можно будет оставить один. 
3. 40 баллов - для заполнения базы в репозитории представлен файл `data.csv`, заполненный ссылками на мемы и прочей информацией
4. 50 баллов - для вывода статистики представлен специальный API запрос, представленный далее

## Установка

1. Склонируйте репозиторий
2. Установите окружение для Python. Выполните в папке команду `python -m venv env` (убедитесь, что используется нужная версия Python) 
3. Активируйте окружение (Windows - `env\Scripts\activate`, Linux - `source env/bin/activate`. Однако учтите, что работоспособность проверялась только на Windows)
4. Установите все зависимости - `python -m pip install r pip.txt`
5. В папках приложены конфиги для детальной настройки приложения и базы данных, но в данном примере будет использоваться SQLite. Для базовой конфигурации не надо никакие конфигурации настраивать и копировать, всё скопируется при первом запуске. 
6. Перейдите в папку приложения (`cd memes`) и выполните `python manage.py migrate` для миграции базы данных. 
7. Для быстрого заполнения базы данных мемами из файла есть команда `python manage.py make_cool`. Она заполняет базу данных из файла `data.csv`, лежащего в корне проекта.
8. Для создания пользователя выполните команду `python manage.py createsuperuser` и введите данные пользователя. Некоторые запросы будут выдавать ошибку 401, если пользователь не авторизован.
9. Для генерации токена выполните команду `python manage.py drf_create_token <имя_пользователя_без_скобок>`. Полученный токен добавьте в файл `config.py` в корне проекта, перед этим скопировав его из файла `config.example.py`.
10. Для запуска сервера выполните команду `python manage.py runserver`.

## Командная строка

Для работы с помощью командной строки был написал файл `interface.py`. Убедитесь, что токен добавлен в файл `config.py`, и запустите интерфейс.
1. Посмотреть все мемы - отображается отформатированный список всем мемов в системе.
2. Показать подборку мемов с сортировкой по дате (требуется авторизация) - задание на 20 баллов по отображению мемов. Там же есть функции оценки.
3. Показать подборку мемов с определенным приоритетом (требуется авторизация) - задание на 30 баллов по отображению мемов. Там же есть функции оценки.
4. Показать статистику (требуются специальные права) - показывает топ-30 мемов по лайкам.

## Методы
`/api/memes/` - показывает все мемы для всех пользователей в формате json.

`/api/feed/` и `/api/feed_new/` - показывают мемы в определенном порядке. Требуют авторизации (заголовок "Authorization: Toke <ваш_токен>"), иначе возвращают ошиюку 401.

`/api/like/<id>/` - поставить лайк (если метод POST) или дизлайк (DELETE) на мем с указанным ID. Требует авторизации

`/api/top/` - показать топ-30 мемов. Требует наличия прав доступа (в колонке БД auth_user is_staff равно 1), иначе выдает ошибку 403.